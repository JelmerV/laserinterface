#:kivy 1.11.0
# <Widget>:
#     canvas.after:
#         Line:
#             rectangle: self.x+1,self.y+1,self.width-1,self.height-1
#             dash_offset: 5
#             dash_length: 3
<MachineView>:
    state: ''
    wpos: ''
    wco: ''
    grid_size: 100

    on_size: root.draw_workspace()

    Widget:
        id: wco_mark
        size_hint: None, None
        size: 30, 30
        canvas:
            Color:
                rgb: (0.8, 0.415, 0.886)
            Line:
                width: 1.1
                group: 'caption'
                points: (self.center_x-self.width/3, self.center_y, self.center_x+self.width/3, self.center_y)
            Line:
                width: 1.1
                group: 'caption'
                points: (self.center_x, self.center_y-self.height/2.1, self.center_x, self.center_y+self.height/2.1,)

    Widget:
        id: wpos_mark
        size_hint: None, None
        size: 20, 20
        canvas:
            Color:
                rgb: (0.9, 0.1, 0.1)
            Line:
                width: 1.1
                group: 'caption'
                points: (self.center_x-self.width/3, self.center_y, self.center_x+self.width/3, self.center_y)
            Line:
                width: 1.1
                group: 'caption'
                points: (self.center_x, self.center_y-self.height/2.1, self.center_x, self.center_y+self.height/2.1,)

    BoxLayout:
        orientation: 'vertical'
        pos_hint: {'right': 0.98, 'top': 0.98}
        size_hint: None, None
        size: 140, 120
        id: caption

        canvas.before:
            Color:
                rgba: (0.4, 0.4, 0.4, 0.4)
            Rectangle:
                pos: self.pos
                size: self.size

        BoxLayout:
            orientation: 'horizontal'
            Label:
                size_hint_x: 0.6
                text: 'Grbl state:'
            Label:
                size_hint_x: 0.4
                text: root.state

        BoxLayout:
            orientation: 'horizontal'
            Label:
                size_hint_x: 0.7
                text: 'Work offset: '
            Label:
                size_hint_x: 0.3
                canvas.after:
                    Color:
                        rgb: (0.8, 0.415, 0.886)
                    Line:
                        width: 1.1
                        group: 'caption'
                        points: (self.center_x-10, self.center_y, self.center_x+10, self.center_y)
                    Line:
                        width: 1.1
                        group: 'caption'
                        points: (self.center_x, self.center_y-10, self.center_x, self.center_y+10)

        Label:
            text: root.wco

        BoxLayout:
            orientation: 'horizontal'
            Label:
                size_hint_x: 0.7
                text: 'Work pos: '
            Label:
                size_hint_x: 0.3
                canvas.after:
                    Color:
                        rgb: (0.9, 0.1, 0.1)
                    Line:
                        width: 1.1
                        group: 'caption'
                        points: (self.center_x-10, self.center_y, self.center_x+10, self.center_y)
                    Line:
                        width: 1.1
                        group: 'caption'
                        points: (self.center_x, self.center_y-10, self.center_x, self.center_y+10)

        Label:
            text: root.wpos

        BoxLayout:
            orientation: 'horizontal'
            Label:
                size_hint_x: 0.7
                text: 'Job size: '
            Label:
                size_hint_x: 0.3
                canvas.after:
                    Color:
                        rgb: (0.20, 0.80, 0.90)
                    Line:
                        width: 1.1
                        group: 'caption'
                        points:
                            (self.center_x+7, self.center_y+5, \
                            self.center_x-7, self.center_y+5, \
                            self.center_x-7, self.center_y-5, \
                            self.center_x+7, self.center_y-5, \
                            self.center_x+7, self.center_y+5)

        BoxLayout:
            orientation: 'horizontal'
            Label:
                size_hint_x: 0.6
                text: 'Grid: '
            Label:
                size_hint_x: 0.4
                text: str(root.grid_size)+'mm'
